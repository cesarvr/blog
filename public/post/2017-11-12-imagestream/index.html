<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>Exporting external images to Openshift :: Cesar&#39;s Bitacora — A simple theme for Hugo</title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="Getting Started First you need to have an Openshift installation on the cloud or in your machine, the second option is the easiest one thanks to the oc cluster up command, this will create a small local installation of openshift in your machine, if your are not familiar take a quick look at the documentation.
Creating a project Once oc cluster up finish you should have an Openshift installation up and ready in your local machine, now next step is to login in and create a project."/>
<meta name="keywords" content=""/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="https://cesarvr.io/post/2017-11-12-imagestream/" />





<link rel="stylesheet" href="https://cesarvr.io/assets/style.css">


<link rel="stylesheet" href="https://cesarvr.io/style.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://cesarvr.io/img/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="https://cesarvr.io/img/favicon.png">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Exporting external images to Openshift"/>
<meta name="twitter:description" content="Getting Started First you need to have an Openshift installation on the cloud or in your machine, the second option is the easiest one thanks to the oc cluster up command, this will create a small local installation of openshift in your machine, if your are not familiar take a quick look at the documentation.
Creating a project Once oc cluster up finish you should have an Openshift installation up and ready in your local machine, now next step is to login in and create a project."/>



<meta property="og:title" content="Exporting external images to Openshift" />
<meta property="og:description" content="Getting Started First you need to have an Openshift installation on the cloud or in your machine, the second option is the easiest one thanks to the oc cluster up command, this will create a small local installation of openshift in your machine, if your are not familiar take a quick look at the documentation.
Creating a project Once oc cluster up finish you should have an Openshift installation up and ready in your local machine, now next step is to login in and create a project." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cesarvr.io/post/2017-11-12-imagestream/" />
<meta property="article:published_time" content="2017-11-12T00:00:00+00:00" />
<meta property="article:modified_time" content="2018-09-03T14:44:47+01:00" /><meta property="og:site_name" content="Cesar&#39;s Bitacora" />






  </head>
  <body class="dark-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367"/>
</svg>
</span>
    <span class="logo__text">Cesar&#39;s Bitacora</span>
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/post">Showcase</a></li>
        
      
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="/post">Showcase</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  <div class="post">
    <h2 class="post-title"><a href="https://cesarvr.io/post/2017-11-12-imagestream/">Exporting external images to Openshift</a></h2>
    <div class="post-meta">
      
        <span class="post-date">
            2017-11-12
        </span>
      
      
      
    </div>

    

    

    <div class="post-content">
      <h1 id="getting-started">Getting Started</h1>
<p>First you need to have an Openshift installation on the cloud or in your machine, the second option is the easiest one thanks to the <code>oc cluster up</code> command, this will create a small local installation of openshift in your machine, if your are not familiar take a quick look at the <a href="https://github.com/openshift/origin/blob/master/docs/cluster_up_down.md#getting-started">documentation</a>.</p>
<h1 id="creating-a-project">Creating a project</h1>
<p>Once <code>oc cluster up</code> finish you should have an Openshift installation up and ready in your local machine, now next step is to login in and create a project.</p>
<pre><code>oc login https://127.0.0.1:8443/  
oc new-project hello
</code></pre><p>The last command will create a project and will keep it as the one in use, so all commands will affect just hello project.</p>
<h1 id="exporting-your-image">Exporting your image</h1>
<p>To import an image you run <code>oc import-image</code> this command will create a new image stream object pointing the image you want to use.</p>
<pre><code>  oc import-image cvr-node:latest --from=docker.io/cvaldezr/nodejs --confirm
</code></pre><h1 id="using-the-image">Using the image</h1>
<p>After successfully importing the image now is time to use it, so to demonstrate this let create a simple Pod object, with  a Node.js application.</p>
<p>First we need the URL of our ImageStream let get it by doing.</p>
<pre><code>$ oc get is

NAME       DOCKER REPO                      TAGS      UPDATED
cvr-node   172.30.1.1:5000/hello/cvr-node   latest    39 seconds ago
</code></pre><p>Next let define our Pod, I want to create a simple app so I'm going to use the example Node.JS.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml">apiVersion: v1
kind: Pod
metadata:
  name: node-example
  labels:
    app: myapp
spec:
  containers:
  - name: myapp-container
    image: <span style="color:#ae81ff">172.30</span><span style="color:#ae81ff">.1</span><span style="color:#ae81ff">.1</span>:<span style="color:#ae81ff">5000</span>/hello/cvr-node  <span style="color:#75715e"># Our imported image</span>
    command: [<span style="color:#e6db74">&#39;/bin/sh&#39;</span>, <span style="color:#e6db74">&#39;-c&#39;</span>]
    args:
    - cd /app/node-openshift-master/;
      echo folder:$PWD;
      npm install;
      nodemon $(node -e <span style="color:#e6db74">&#34;console.log(require(&#39;./package.json&#39;).main)&#34;</span>)


    volumeMounts:
    - mountPath: /app
      name: app-volume
    - mountPath: /.npm  
      name: npm-cache

    ports:
    - containerPort: <span style="color:#ae81ff">8080</span>
  initContainers:
  - name: cloning  
    image: busybox
    command: [<span style="color:#e6db74">&#39;/bin/sh&#39;</span>, <span style="color:#e6db74">&#39;-c&#39;</span>]
    args:
    - cd /app/;
      wget -O src.zip https://github.com/cesarvr/node-openshift/archive/master.zip;
      unzip src.zip -d /app/;  
      rm src.zip;

    volumeMounts:
    - mountPath: /app
      name: app-volume
  volumes:
  - name: app-volume
    emptyDir: {}    
  - name: npm-cache
    emptyDir: {}   
</code></pre></div><p>We create the Pod</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">oc create -f node.yml  
</code></pre></div><p>After some initialization, assuming that everything is fine we should our Pod running, next thing is to expose it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">oc expose pod node-example
oc expose service node-example  
</code></pre></div><h3 id="demo">Demo</h3>
<!-- raw HTML omitted -->

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h">Read other posts</span>
            <hr />
          </div>
          <div class="pagination__buttons">
            
              <span class="button previous">
                <a href="https://cesarvr.io/post/2017-12-01-cordova-pdf-generator/">
                  <span class="button__icon">←</span>
                  <span class="button__text">How to generate a PDF Documents using Cordova, for Android and IOS</span>
                </a>
              </span>
            
            
              <span class="button next">
                <a href="https://cesarvr.io/post/2015-11-20-javascript-v8/">
                  <span class="button__text">Embedding Javascript v8</span>
                  <span class="button__icon">→</span>
                </a>
              </span>
            
          </div>
        </div>
      
    
    

    
      
        

      
    
    
    </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367"/>
</svg>
</span>
    <span class="logo__text">Cesar&#39;s Bitacora</span>
    <span class="logo__cursor"></span>
  
</a>

      <div class="copyright">
        <span>© 2020 Powered by <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a></span>
        <span>Theme created by <a href="https://twitter.com/panr" target="_blank" rel="noopener">panr</a></span>
      </div>
    
  </div>
</footer>

<script src="https://cesarvr.io/assets/main.js"></script>
<script src="https://cesarvr.io/assets/prism.js"></script>


      
    </div>

    
  </body>
</html>
